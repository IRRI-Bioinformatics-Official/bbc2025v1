<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>PostGWAS module</title>
<style>
body {
	font-family: Arial, sans-serif;
	margin: 0;
	padding: 0;
	line-height: 1.6;
	display: flex;
	margin-bottom: 100px;
}

html, body {
	height: 100%;
	overflow: auto;
	overscroll-behavior: contain;
}

/* Floating Table of Contents */
#toc {
	position: fixed;
	top: 0px;
	left: 20px;
	width: 200px;
	background-color: #f8f9fa;
	padding: 1rem;
	border-radius: 8px;
	box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
	z-index: 1000;
}

#toc h2 {
	font-size: 1.2rem;
	margin-bottom: 1rem;
}

#toc ul {
	list-style-type: none;
	font-size: .9rem;
	padding: 0;
}

#toc ul li {
	margin: 0.5rem 0;
}

#toc ul li a {
	text-decoration: none;
	color: #007bff;
}

#toc ul li a:hover {
	text-decoration: underline;
}
/* Main content styling */
main {
	margin-left: 240px; /* Adjusted for TOC width */
	padding: 2rem;
	flex-grow: 1;
}

h1, h2 {
	color: #2c3e50;
}

section {
	margin-bottom: 2rem;
	max-width: 800px;
	padding: 20px;
	background-color: white;
	border-radius: 8px;
	box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

pre, code {
	background-color: #ededed;
	color: #312f2f;
	padding: 5px 10px;
	border-radius: 4px;
	font-size: .9em;
	font-family: Consolas, monospace;
	overflow-x: auto;
}

code {
	font-size: 1em;
	background-color: #ededed;
	padding: 2px 5px;
	border-radius: 3px;
}

ul {
	list-style-type: none;
	padding-left: 20px;
}

ul li {
	margin-bottom: 10px;
}

ol {
	padding-left: 20px;
}

li {
	margin-bottom: 10px;
}

strong {
	color: #2c3e50;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  body {
    flex-direction: column;
  }

  #toc {
    position: static;
    width: auto;
    box-shadow: none;
    margin: 1rem;
  }

  main {
    margin-left: 0;
    padding: 1rem;
  }
}

@media (max-width: 480px) {
  #toc h2 {
    font-size: 1rem;
  }

  #toc ul li {
    font-size: 0.85rem;
  }

  section {
    padding: 1rem;
  }

  pre, code {
    font-size: 0.85em;
  }
}



</style>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const toc = document.getElementById("toc");
    const toggleBtn = document.getElementById("toggleToc");

    function checkScreenWidth() {
      if (window.innerWidth <= 768) {
        toggleBtn.style.display = 'block';
        toc.style.display = 'none';
      } else {
        toggleBtn.style.display = 'none';
        toc.style.display = 'block';
      }
    }

    toggleBtn.addEventListener("click", () => {
      toc.style.display = (toc.style.display === 'none') ? 'block' : 'none';
    });

    window.addEventListener("resize", checkScreenWidth);
    checkScreenWidth();
  });
</script>

</head>
<body>
	<script>
    document.addEventListener("DOMContentLoaded", function () {
      const tocLinks = document.querySelectorAll('#toc a[data-target]');
      tocLinks.forEach(link => {
        link.addEventListener('click', function (e) {
          e.preventDefault();
          const targetId = this.getAttribute('data-target');
          const targetElement = document.getElementById(targetId);
          if (targetElement) {
            targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
          }
        });
      });
    });
  </script>
	<!-- Floating Table of Contents -->
	<div id="toc">
		<h2>Module 4:</h2>
		<ul>
			<li><a href="#" data-target="overview">i. Module Overview</a></li>
			<li><a href="#" data-target="section-1">I. Post-GWAS Analysis </a></li>
			<li><a href="#" data-target="section-2">II. Post-GWAS Considerations</a></li>
			<li><a href="#" data-target="section-3">III. Candidate Gene(CG) Analysis</a></li>
			<li><a href="#" data-target="section-4">IV. Basic CG Analysis Workflow</a></li>
			<li><details>
				<summary>
					<a href="#"> V. Online tools for post-GWAS </a>
				</summary>
				<li><a href="#" data-target="section-5a">A. Rice SNPSeek</a></li>
				<li><a href="#" data-target="section-5b">B. CropGalaxy</a></li>
				<li><a href="#" data-target="section-5c">C. RicePilaf</a></li>
			</details></li>
			<li><a href="#" data-target="section-6">VI. Summary</a></li>
			<li><a href="#" data-target="section-7">VII. References</a></li>
			<li><a href="homework.html" target="blank">VIII. Homework </a></li>
		</ul>
	</div>


	<!-- Main Content -->
	<main style="margin-bottom: 100px;margin-top:20px;">
		<button id="toggleToc" style="display: none;">‚ò∞ Table of Contents</button>
		
		<section id="overview">
			<h2>üß≠ Training Overview: Basic Post-GWAS Analysis</h2>

			<h3>üéØ Topic: PostGWAS Analysis using SNPSeek, CropGalaxy, and RicePilaf</h3>
			<h4>In this module, we will cover basic analysis methods for identification of candidate genes from highly associated genome-wide association studies (GWAS) regions. We will also predict the putative effects of SNPs on identified candidate genes. We will use the following rice-specific tools:</h4>
				<p>
					<ul> 
						<li> Rice SNP-Seek</li>
						<li> CropGalaxy</li>
						<li> RicePilaf</li>
					</ul>
				</p>

			<h3>üë• Target Audience</h3>
			<p>Participants should have a background on genome-wide association analysis.</p>

			<h3>üèÅ Goal</h3>
			<label>
				<ul>
					<li><input type="checkbox"> Understand the concept of post-GWAS analysis </li>
					<li><input type="checkbox"> Be familiar with tools and resources available for doing post-GWAS gene-related analysis on rice genomics data</li>
					<li><input type="checkbox"> Perform ‚Äúminimum‚Äù standard post-GWAS analysis using Rice SNP-Seek, CropGalaxy, and RicePilaf </li>
				</ul>
			  </label>
		</section>

		<section id="section-1">
			<h2>Post-GWAS Analysis</h2>
			<p>Genome-wide association studies (GWAS) is instrumental in identifying genetic variants associated with various traits. However, the raw results from GWAS, typically in the form of significant single nucleotide polymorphisms (SNPs), are only the beginning. Performing post-GWAS analysis is a crucial subsequent step to interpret these associations, understand underlying biological mechanisms, and subsequently apply this information to breeding programs.
			</p>
			<h3>Why perform Post-GWAS analysis?</h3>
			<ul>
				<li>
					Post-GWAS analysis helps validate the results from the genome-wide association study (GWAS) to better understand the biological functions and mechanisms that link the significant variants (i.e, SNPs) to the trait of interest.
				</li>
				<li>
					Post-GWAS analysis in rice involves the use of various bioinformatics tools and databases to prioritize candidate
					genes, validate their functions, and integrate findings into practical breeding strategies.
				</li>
				<li>
					<h4>Some questions that can be answered in performing post-GWAS analysis:</h4>
					<ul>
						<li> 
							<i>- Is there support from annotation for the loci?</i>
						</li>
						<li>
							<i>- Are there known genes with functional evidence?</i>
						</li>
						<li>
							<i>- Are there SNPs that affect function?</i>
						</li>
						<li>
							<i>- Do the haplotypes make sense?</i>
						</li>
					</ul>
				</li>
			</ul>
		</section>

		<section id="section-2">
			<h2>Post-GWAS Analysis Considerations</h2>
			<h3>In performing post-GWAS analysis, it is important to consider several points:</h3>
			<p>
				<ol>
					<li>
						<h4>Significance of the SNP</h4>
						<ul>
							<li>
								Smaller p-values, below the significance threshold  (SNP is significantly associated with the trait)
								<p>For more information about SNPs and its effects, refer to this <a href="https://online.stat.psu.edu/stat555/node/18/">external lesson</a> and the previous module on GWAS.</p>
							</li>

						</ul>
					</li>
					<li><h4>Use appropriate statistical methods to validate associations and prioritize candidate genes.</h4></li>
					<li><h4>Integrate functional genomics data, such as gene expression and protein-protein interactions, to support candidate gene selection. </h4></li>
					<li><h4>Consider the potential impact of environmental factors on trait expression and genetic associations. </h4></li>
					<li><h4>Utilize available databases and tools for functional annotation and visualization of GWAS results.</h4></li>
				</ol>
			</p>
		</section>

		<section id="section-3">
			<h2>Candidate Gene (CG) Analysis</h2>
			<h3>Assuming you have significant GWAS peaks, the next step would be to identify candidate genes responsible for your trait of interest. Candidate gene analysis focuses on investigating specific genes that are believed to be biologically relevant to the trait or disease under study (an example in Figure 3.1).
			</h3>
			<p style="text-align:left;">
				<img src="images/figure_3_1.png" alt="Information Flow (Figure 3.1)" style="max-width:100%; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.08);">
				<br>
				<em><b>Figure 3.1. </b> Information flow from GWAS study, identified GWAS QTL, genes under GWAS QTL, leading to post-GWAS analysis (using days to 80% heading as trait from the 3K Rice Genomes project).</em>
			</p>
			<br>
			<ul>
				<li>
					<strong>Candidate gene </strong>- a gene that has been identified as related to a particular trait such as phenotype, disease, or condition, (Varshney, 2006)
				</li>
				<li>
					<strong>Analysis framework for post-GWAS analysis:</strong>
					<ol>
						<li><a href="https://www.ndsu.edu/pubweb/~mcclean/plsc411/Lecture%205.%20forward%20genetics_XL2018Sep.pdf">Forward Genetics </a>: </li>
						<p>
							<i>‚ÄúI have a QTL from a GWAS study, mapped using markers from the rice reference (Nipponbare) genome, how does the QTL *look* like in another genome of a variety that‚Äôs more closely related to my material?‚Äù</i>
						</p>

						<p>Rice varieties, especially those in different sub-populations, may contain sets of genes that are distinct from each	other. QTL regions, when inspected in a particular genome (e.g. japonica Nipponbare) may be lacking some genes in the equivalent QTL region when inspected in another variety‚Äôs genome (e.g. aus N22), and vice-versa.</p>
						<li><a href="https://en.wikipedia.org/wiki/Gene_set_enrichment_analysis">Enriched/over-represented biological theme(s)</a> from a selected list of genes</li>
						 <i>‚ÄúI have a list of genes from a small QTL from GWAS, and I wish to know more of the biology behind this gene list.‚Äù</i>
						 <p>The set of CGs in the QTL may have a particular biological theme  (e.g. metabolic pathway/process, a particular gene function, or a component of a cellular or organ structure) over-represented in this subset, that may be important to the trait of interest. </p>
					</ol>
				</li>
				
			</ul>
		</section>

		<section id="section-4">	
			<h2>Basic CG analysis Workflow</h2>
			<h3>There are many ways to perform candidate gene analysis. Below is a simple workflow to do CG analysis. </h3>
			<p style="text-align:left;">
				<img src="images/figure_4_1.png" alt="CG Analysis Workflow (Figure 4.1)" style="max-width:100%; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.08);">
				<br>
				<em><b>Figure 4.1.</b> Simple workflow to do candidate gene analysis</em>
			</p>
			<ol>
				<li><p> <b>Create SNP List </b> or range of SNP positions in genome (chr, range of positions of SNPs in base pair, example Chr01:1000-10000; Chr02:3000-50000) </p></li>
				<li><p><b>Generate gene list</b> within the given range.</p></li>
				<li><p><b>Analyze genes for associated information</b> (as a separate exercise, also identify Marker/SNP effect on candidate genes using snpEff)</p></li>
				<li><p><b>Use other k-nown/computed information using other tools (e.g. websites such as RicePilaf, KnetMiner Cereals, RiceNet)</b></p>
					<ul>
						<li><b>a. Identify enriched biological themes </b> associated with the gene list</li>
						<li><b>b. Identify co-expressed genes (co-expression network)</b> : genes that are <em>in cis</em> (contiguous to the associated SNPs) or <em>in trans</em> (genes located outside the GWAS region (may be in the same chromosome but far away from the GWAS region or totally in another chromosome) and <b>NOT</b> in the identified gene list).</li>
					</ul>
				</li>
			</ol>
			<p>Several publicly available tools can be used to perform this kind of analysis. In the next section, you will learn about three of them: Rice SNPSeek, Rice-CropGalaxy, and RicePilaf.</p>
		</section>

		<section id="section-5a">	
			<h2>Rice SNPSeek (v3)</h2>
			
			<p><h3>Rice SNPSeek (v3) is an online web application that provides a user-friendly, comprehensive database for the genetic variations, phenotypes, and variety information of the 3000 rice genomes accessions. </h3> <a href="">Click here</a> to know more about the 3K Rice Genomes project, and for knowledge about the scientific output of the 3K RG project, read Genomic variation in 3,010 diverse accessions of Asian cultivated rice</p>
			
			<p>Required reading: <a href="">Rice SNP-Seek database update: new SNPs, indels, and queries</a></p>
				<p><i>image here...</i></p>
				<p>Rice SNPSeek  offers the following functionalities:
					<li>Search queries:<p>Rice SNPSeek allows users to search genotypes against single to multiple reference genomes, gene loci of interest, as well as varietal passport and morphological data. It   also allows combined queries on the 3K rice genomes and other rice datasets hosted in the platform. Users can also generate genotype matrices of indels across multiple varieties.</p></li>
					<li>Genome Visualization:<p>The application allows genome visualizations to display the sequences and gene models, as well as the alignment of the 3000 rice accessions against the reference. This helps in verifying visually whether SNP locations lie within or nearby certain gene loci.</p></li>
					<li>SNP/Marker Annotator:<p>Users can create a list of significant markers from their GWA studies and use this feature to annotate markers with evidence from other databases and/or analyses such as rice gene models, and SNP effects from SNPeff results.</p></li>
				</p>
				<p>These are only some of the functionalities that Rice SNPSeek offers. To use the platform and know more about its features, go to the SNP-Seek v3 site.</p>
				<p>
					The figure below shows the connection between several query workflows. Users can construct a variety list or a locus list, then use these in genotype query. SNP lists, on the other hand, can be extracted from a genotype query, and constrain another genotype query. Finally, one can annotate SNPs using Marker Annotator to help prioritize candidate genes from GWAS.
					<p><i>image here...</i> </p>
				</p>
				<p>
					Here‚Äôs a video demonstrating the key features of Rice SNPSeek.
					<p><i>video here ...</i></p>
				</p>
		</section>

		<section id="section-5b">	
			<h2>CropGalaxy</h2>
			
			<h3>CropGalaxy is a federated instance of Galaxy which houses tools and datasets for crop genomic analysis. It stemmed from the original Galaxy platform initially developed for biomedical research. To learn more about the Galaxy platform, go to this link and read this paper - The Galaxy platform for accessible, reproducible, and collaborative data analyses: 2024 update.</h3>
			<p>Required reading: <a href="">Rice Galaxy: an open resource for plant science</a></p>

			<p>Recall in the Linux module that you learned how to run analysis software under the command-line environment. Galaxy provides a graphical interface ‚Äúwrapper‚Äù to these command-line tools so that you don‚Äôt need to remember how to type-in these commands. It  also provides a workflow environment where you can ‚Äústring‚Äù a series of commands you repeatedly use in an analysis series. </p>
			<p><i>image here... </i></p>
			<p>Galaxy offers three core features that fit our needs in rice genomics:</p>
			<ul>
				<li>Accessibility. The platform enables users without programming experience to run tools and workflows easily by providing a graphical user interface to bioinformatics tools commonly run on command-line.
</li>
				<li>Reproducibility.Galaxy captures information so that any user can repeat and understand the complete computational analysis done.</li>
				<li>Transparency. Galaxy allows users to share and publish analyses via the web and create interactive, web-based documents that describe the complete analysis.
</li>
			</ul>
			<p><i>image here...</i></p>
			<p>CropGalaxy contains shared datasets such as high-density genotypes from the 3KRG, and annotations of new reference genomes for rice. It also offers freely available tools to empower the plant research community to perform genomics analyses: GWAS, post-GWAS, primer design, population diversity and genomic prediction.
</p>
			<p>Here‚Äôs a video on how to access CropGalaxy, as well as some of the functionalities of the platform.
</p>
			<p><i>video here ...</i></p>
			<p>Candidate Gene Analysis:
				<br>
				To perform candidate gene analysis in CropGalaxy, we will be using most of the tools in the tool-suite named: RiceGalaxy: SNP Data Tools. Here, we have a set of tools dedicated for this type of analysis:
				<ul>
					<li>Get Genes by Region IDs</li>
					<li>Fast Preranked Gene Set Enrichment Analysis (FGSEA2)</li>
					<li>Find Gene by terms/li>
					<li>Lift-Over via SNP</li>
					<li>...</li>
				</ul>
				<i>image here...</i>
			</p>
			<p>In this section, we will use Lift-over via SNP to demonstrate how to use CropGalaxy in finding candidate genes.</p>
			<p>Let‚Äôs take for instance the DTF_SS (days to flower under severe stress) QTL, qDTF2.2,reported in this publication. The SNPs used were based on Nipponbare which belongs to japonica subpopulation. However, the donor parent is aus-type.  We want to look into these Nipponbare-based (japonica) markers to see where they lie in the N22 (aus-type) genome, and look for candidate genes, as well as annotations we can use to derive more understanding about our QTL/trait of interest.</p>
			<p>See the <a href="">workflow</a> described here  to see the whole process.</p>
		</section>

		<section id="section-5c">	
			<h2>RicePilaf</h2>
			<h3>RicePilaf is a web-based post-GWAS/QTL application that integrates pangenomic, coexpression, regulatory, epigenomic, ontology, pathway, and text-mining information. It aims to provide functional insights into rice QTLs and GWAS regions identified from QTL and GWAS mapping studies.</h3>
			<p>‚ö†Ô∏èBefore proceeding with this section, read the <a href="">RicePilaf publication</a> first, this is required reading! 
				<br>
				In this publication, you are expected to learn the various tools incorporated in RicePilaf, and have an overview of the algorithms/computational methods used in these tools.
			</p>
			<p>An overview of RicePilaf‚Äôs functionalities is shown in Figure 7.1.</p>
			<p><i>image here...</i></p>
			<p>A typical analysis flow in RicePilaf is illustrated in the diagram in Figure 7.2.</p>
			<p><i>image here...</i></p>
			<p>
				Watch the example RicePilaf analysis (video) using preharvest sprouting QTLs, from the RicePilaf paper. In this video, step-by-step analysis of the pre-harvest sprouting QTLs is demonstrated, for each of the component tools in RicePilaf. 
				<br>
				Look at the video description in YouTube for the corresponding time-stamped chapters. The tools demonstrated are the following:
				<ul>
					<li>Gene List and lift-over: include MH63, IR64 genomes
						<ul>
							<li>0:07 Select PHS example as interval for analysis</li>
							<li>0:10 Click on "Proceed to Analyses Menu"</li>
							<li>0:14 Using the "Gene List and Lift-Over" menu</li>
							<li>0:25 Select genome for lift-over on drop-down menu</li>
							<li>0:36 Select MH63 genome</li>
							<li>0:41 Add IR64 genome</li>
							<li>0:47 Click on "Show gene list" and inspecting/navigating the result output</li>
							<li>1:48 exporting the results as csv file</li>
						</ul>
					</li>
					<li>Gene retrieval by text mining: Use ‚Äúpre-harvest sprouting‚Äù as key search phrase
						<ul>
							<li>1:58 Using the "Gene retrieval by text mining" tool</li>
							<li>2:05 select the example query "pre-harvest sprouting"</li>
							<li>2:13 Inspecting the output of the "gene retrieval by text mining" tool</li>
						</ul>
					</li>

					<li>Coexpression network analysis: Inspect the top 2 modules and the connectivity of the GWAS genes with other genes in the network
						<ul>
							<li>2:39 Using the "Coexpression Network Analysis" tool</li>
							<li>3:05 Inspecting the output of the Coexpression analysis tool</li>
							<li>3:15 Inspecting the top module (most significant) output in detail</li>
							<li>3:37 Inspecting the connection of the 3 genes from the region to other genes in the network</li>
							<li>4:02 Inspecting another module output (the 2nd significant)</li>
							<li>4:09 Inspecting the connection of the 2 genes from the region to other genes in the network</li>
						</ul>						
					</li>
					<li>Regulatory feature enrichment tool use and inspection of the output
						<ul>
							<li>4:25 Using the "Regulatory Feature Enrichment" tool</li>
							<li>4:45 Inspecting the output of the Regulatory feature enrichment tool</li>
						</ul>
					</li>
					<li> Epigenomic information tool, inspect the output for 2 QTLs, note the active and inactive regions based on the results in the genome browser
						<ul>
							<li>5:01 Using the "epigenomic information" tool</li>
							<li>5:33 Inspecting the output of the epigenomic information tool (1st interval) - with inactive regions </li>
							<li>5:46 Inspecting the output of the epigenomic information tool (2nd interval) - no inactive region</li>
						</ul>
					</li>
					<li>Generate the Summary output of the analyses, explore the output table.
						<ul>
							<li>6:14 Generating the summary output of all tools</li>
							<li>6:30 Inspecting the gene list from the summary output</li>
						</ul>
					</li>
					<li>Inspecting the gene list from the summary output
						<ul>
							<li>7:01 Reset all analyses before running a fresh one.</li>
						</ul>
					</li>
				</ul>
			</p>
		</section>

		<section id="section-6">	
			<h2>Summary</h2>
			<h3>In this module, we introduced three web resources specialized for rice post-GWAS analysis: Rice SNP-Seek, CropGalaxy, RicePilaf. It is expected that you have learned how to use these online resources using the sample datasets provided.</h3>
			
			<ul>
				<li><p>Post-GWAS analysis is an essential step after identifying genome regions (either by GWAS or QTL mapping) that are associated with traits of interest. A typical QTL identified from GWAS may span a large portion of the genome and contain up to thousands of genes within the region, and it is a resource-intensive exercise to experimentally study these genes within the GWAS region.</li></p>
				
				<li><p>Utilizing analysis frameworks implemented in the various tools demonstrated provides a systematic method of filtering and prioritizing candidate genes for further experimentation, resulting in a reduction from hundreds to thousands to potentially tens of genes to investigate. Furthermore, genes that are not within the QTL region that may be causative to the trait of interest could be identified; such genes could be missed if the information used is only the QTL region from GWAS.</li></p>
				
				<li><p>Post-GWAS analysis is by no means an endpoint to CG discovery itself but rather it presents a smaller and better-informed set of candidate genes as hypotheses for further testing.</li></p>
				
			</ul>

		</section>
		
		<section id="section-7">	
			<h2><u>References</u></h2>
			<p>
				<ul>
					<li> The 3,000 rice genomes project. https://doi.org/10.1186/2047-217X-3-7</li>
					<li>Genomic variation in 3,010 diverse accessions of Asian cultivated rice. https://doi.org/10.1038/s41586-018-0063-9</li>
					<li>Varshney, R. K., Graner, A., & Sorrells, M. E. (2006). Genic microsatellite markers in plants: features and applications. Trends in Biotechnology, 24(2), 71-81.</li>
					<li>Rice SNP-Seek database update: new SNPs, indels, and queries. https://doi.org/10.1093/nar/gkz1020</li>
					<li>Rice Galaxy: an open resource for plant science. https://doi.org/10.1093/gigascience/giz028</li>
					<li>RicePilaf: a web-based post-GWAS/QTL application for functional insights into rice QTLs and GWAS regions. https://doi.org/10.1093/gigascience/giae013</li>
				</ul>
			</p>
		</section>
		
		</br> </br> </br>
	</main>
	
</body>

</html>
